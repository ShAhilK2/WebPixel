"use strict";(function(){if(typeof window>"u"){console.log("Not in a window environment");return}const d=document.currentScript,m=d?.getAttribute("data-domain"),l=d?.getAttribute("data-site-id");if(!m&&!l)return;const h="/api/collect",o=()=>{const t=Date.now().toString(36),n=Math.random().toString(36).substring(2,15);return`${t}-${n}`},u="_px_vid",g="_px_sid";let a,r;try{a=localStorage.getItem(u)||o(),localStorage.setItem(u,a),r=sessionStorage.getItem(g)||o(),sessionStorage.setItem(g,r)}catch{a=o(),r=o()}let i=performance.now(),s=0,e=null;const p=new URLSearchParams(location.search),v=p.get("utm_source"),S=p.get("utm_campaign"),w=(t,n={})=>JSON.stringify({type:t,domain:m,siteId:l,visitorId:a,sessionId:r,url:location.href,referrer:document.referrer||null,screenWidth:screen.width,userAgent:navigator.userAgent,utm_campaign:S,utm_source:v,timestamp:Date.now(),...n}),c=(t,n)=>{fetch(h,{method:"POST",body:w(t,n),headers:{"Content-Type":"application/json"},keepalive:!0}).catch(()=>{})},I=()=>{s+=performance.now()-i,c("page_exit",{active_time:Math.round(s)})},f=()=>{e||(e=setInterval(()=>c("heartbeat"),1e4))},_=()=>{e&&(clearInterval(e),e=null)};c("page_view"),f(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(s+=performance.now()-i,_()):(i=performance.now(),f())}),window.addEventListener("pagehide",I)})();
